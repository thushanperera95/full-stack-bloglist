(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{41:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(16),c=n.n(a),o=n(2),i=n.n(o),u=n(4),s=n(3),l=n(0),d=function(e){var t=e.blog,n=e.incrementBlogLikes,a=e.deleteBlog,c=e.loggedInUser,o=Object(r.useState)(!1),i=Object(s.a)(o,2),u=i[0],d=i[1],b=u?"Hide":"Show",p=t.user&&c.username===t.user.username;return Object(l.jsxs)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},children:[Object(l.jsxs)("div",{className:"blogOverview",children:[t.title," ",t.author," ",Object(l.jsx)("button",{onClick:function(){return d(!u)},children:b})]}),u&&Object(l.jsxs)("div",{className:"blogDetails",children:[t.url,Object(l.jsx)("br",{}),"likes ",t.likes," ",Object(l.jsx)("button",{onClick:function(){n(t)},children:"like"}),Object(l.jsx)("br",{}),t.user&&t.user.name,p&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("br",{}),Object(l.jsx)("button",{onClick:function(){window.confirm("Remove blog ".concat(t.title," by ").concat(t.author,"?"))&&a(t.id)},style:{background:"lightblue"},children:"remove"})]})]})]})},b=function(e){var t=e.blogs,n=e.incrementBlogLikes,r=e.deleteBlog,a=e.loggedInUser;return Object(l.jsx)(l.Fragment,{children:t.sort((function(e,t){return e.likes>t.likes?-1:1})).map((function(e){return Object(l.jsx)(d,{blog:e,incrementBlogLikes:n,deleteBlog:r,loggedInUser:a},e.id)}))})},p=function(e){var t=e.handleLogin,n=Object(r.useState)(""),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(""),u=Object(s.a)(i,2),d=u[0],b=u[1];return Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({username:c,password:d}),o(""),b("")},children:[Object(l.jsxs)("div",{children:["username",Object(l.jsx)("input",{type:"text",value:c,name:"Username",onChange:function(e){var t=e.target;return o(t.value)}})]}),Object(l.jsxs)("div",{children:["password",Object(l.jsx)("input",{type:"password",value:d,name:"Password",onChange:function(e){var t=e.target;return b(t.value)}})]}),Object(l.jsx)("button",{type:"submit",children:"login"})]})},j=function(e){var t=e.user,n=e.handleLogout;return Object(l.jsxs)("p",{children:[t.name," logged in",Object(l.jsx)("button",{onClick:n,children:"logout"})]})},f=function(e){var t=e.createBlog,n=Object(r.useState)(""),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(""),u=Object(s.a)(i,2),d=u[0],b=u[1],p=Object(r.useState)(""),j=Object(s.a)(p,2),f=j[0],g=j[1];return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"create new"}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:d,url:f}),o(""),b(""),g("")},children:[Object(l.jsxs)("div",{children:["title:",Object(l.jsx)("input",{type:"text",value:c,name:"title",id:"input-title",onChange:function(e){var t=e.target;return o(t.value)},required:!0})]}),Object(l.jsxs)("div",{children:["author:",Object(l.jsx)("input",{type:"text",value:d,name:"author",id:"input-author",onChange:function(e){var t=e.target;return b(t.value)},required:!0})]}),Object(l.jsxs)("div",{children:["url:",Object(l.jsx)("input",{type:"text",value:f,name:"url",id:"input-url",onChange:function(e){var t=e.target;return g(t.value)},required:!0})]}),Object(l.jsx)("button",{type:"submit",children:"create"})]})]})},g=Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(""),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(""),u=Object(s.a)(i,2),d=u[0],b=u[1],p=function(e){o("error"),f(e)},j=function(e){o("info"),f(e)},f=function(e){b(e),setTimeout((function(){o(""),b("")}),5e3)};Object(r.useImperativeHandle)(t,(function(){return{displayErrorNotification:p,displayInfoNotification:j}}));return Object(l.jsx)("div",{className:"notification",style:function(){switch(c){case"error":return{color:"red",background:"lightgrey",fontSize:"20px",borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"20px"};case"info":return{color:"green",background:"lightgrey",fontSize:"20px",borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"20px"};default:return{display:"none"}}}(),children:d})}));g.displayName="Notification";var v=g,O=Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(!1),a=Object(s.a)(n,2),c=a[0],o=a[1],i={display:c?"none":""},u={display:c?"":"none"},d=function(){o(!c)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:d}})),Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{style:i,children:Object(l.jsx)("button",{onClick:d,children:e.buttonLabel})}),Object(l.jsxs)("div",{style:u,children:[e.children,Object(l.jsx)("button",{onClick:d,children:"cancel"})]})]})}));O.displayName="Togglable";var h=O,x=n(6),m=n.n(x),y="/api/blogs",w=null,k={setToken:function(e){w="bearer ".concat(e)},getAll:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get(y);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(u.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},e.next=3,m.a.post(y,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(u.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.put("".concat(y,"/").concat(t),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(w),e.next=3,m.a.delete("".concat(y,"/").concat(t),{headers:{Authorization:w},data:{id:t}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S={login:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};var B=function(){var e=Object(r.useState)([]),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),o=Object(s.a)(c,2),d=o[0],g=o[1],O=Object(r.useRef)(),x=Object(r.useRef)();Object(r.useEffect)(Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.getAll();case 2:t=e.sent,a(t);case 4:case"end":return e.stop()}}),e)}))),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);k.setToken(t.token),g(t)}}),[]);var m=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),k.setToken(n.token),g(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),x.current.displayErrorNotification(e.t0.response.data.error);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedBlogappUser"),g(null),x.current.displayInfoNotification("you have logged out");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(u.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.create(t);case 3:r=e.sent,a(n.concat(r)),O.current.toggleVisibility(),x.current.displayInfoNotification("a new blog ".concat(r.title," by ").concat(r.author," added")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),x.current.displayErrorNotification(e.t0.response.data.error);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(u.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.likes+=1,e.next=4,k.update(t.id,t);case 4:r=e.sent,a(n.map((function(e){return r.id!==e.id?e:r}))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),x.current.displayErrorNotification(e.t0.response.data.error);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.remove(t);case 3:a(n.filter((function(e){return e.id!==t}))),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),x.current.displayErrorNotification(e.t0.response.data.error);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"blogs"}),Object(l.jsx)(v,{ref:x}),null===d&&Object(l.jsx)(p,{handleLogin:m}),null!==d&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(j,{user:d,handleLogout:function(){return y()}}),Object(l.jsx)(h,{buttonLabel:"new note",ref:O,children:Object(l.jsx)(f,{createBlog:w})}),Object(l.jsx)(b,{blogs:n,incrementBlogLikes:B,deleteBlog:N,loggedInUser:d})]})]})};c.a.render(Object(l.jsx)(B,{}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.a22fed83.chunk.js.map